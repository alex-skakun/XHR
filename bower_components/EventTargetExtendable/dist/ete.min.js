!function(t,EventCollection,EventCollectionItem){"use strict";function e(t){var e=r.findForTarget(t);return e||(e=new EventCollectionItem(t),r.add(e)),e}function EventTargetExtendable(t){if(Array.isArray(t)){var e={};t.forEach(function(t){var r=t.trim().toLowerCase(),n="on"+r;Object.defineProperty(this,n,{enumerable:!0,configurable:!1,get:function(){return e[r]||null},set:function(t){var n=e[r];n&&this.removeEventListener(r,n),"function"==typeof t&&(e[r]=t,this.addEventListener(r,t))}})},this)}}var r=new EventCollection;EventTargetExtendable.prototype.addEventListener=function(t,r){if("function"==typeof r){var n=e(this);return n.addListener(t,r)}return!1},EventTargetExtendable.prototype.removeEventListener=function(t,r){var n=e(this);return n.removeListener(t,r)},EventTargetExtendable.prototype.dispatchEvent=function(t){var r=e(this),n=r.getListenersByType(t),i=Array.prototype.slice.call(arguments,1),o=this;n&&n.forEach(function(t){"function"==typeof t&&t.apply(o,i)})},EventTargetExtendable.prototype.removeAllListeners=function(t){var n=e(this);return t?n.removeListeners(t):r.remove(n)};for(var n=EventTargetExtendable.prototype,i=Object.keys(EventTargetExtendable.prototype),o=0,s=i.length;s>o;o++)Object.defineProperty(n,i[o],{enumerable:!1,configurable:!1,writable:!1});t.EventTargetExtendable=EventTargetExtendable}(this,function(){"use strict";function EventCollection(){var t;try{t=Map}catch(e){t=Array}this.collection=new t}return EventCollection.prototype.findForTarget=function(t){if(!Array.isArray(this.collection))return this.collection.get(t);for(var e=this.collection,r=0,n=e.length;n>r;r++){var i=e[r];if(i.target===t)return i}return null},EventCollection.prototype.add=function(t){Array.isArray(this.collection)?this.collection.push(t):this.collection.set(t.target,t)},EventCollection.prototype.remove=function(t){if(Array.isArray(this.collection)){var e=this.collection.indexOf(t);if(e>-1){var r=this.collection.splice(e,1);return 1===r.length}return!1}return this.collection["delete"](t.target)},EventCollection}(),function(){"use strict";function EventCollectionItem(t){this.target=t,this.listeners={}}return EventCollectionItem.createListenersCollection=function(){var t;try{t=Set}catch(e){t=Array}return new t},EventCollectionItem.prototype.getListenersByType=function(t){var e=this.listeners[t];return e||(e=EventCollectionItem.createListenersCollection(),this.listeners[t]=e),e},EventCollectionItem.prototype.addListener=function(t,e){var r=this.getListenersByType(t);return Array.isArray(r)?~r.indexOf(e)?!1:(r.push(e),!0):r.has(e)?!1:(r.add(e),!0)},EventCollectionItem.prototype.removeListener=function(t,e){var r=this.getListenersByType(t);if(Array.isArray(r)){var n=r.indexOf(e);if(n>-1){var i=r.splice(n,1);return 1===i.length}return!1}return r["delete"](e)},EventCollectionItem.prototype.removeListeners=function(t){var e=this.getListenersByType(t);return Array.isArray(e)?e.splice(0,e.length):e.clear(),!0},EventCollectionItem}());